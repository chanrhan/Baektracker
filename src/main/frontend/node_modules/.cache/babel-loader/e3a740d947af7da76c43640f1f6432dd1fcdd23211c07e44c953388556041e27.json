{"ast":null,"code":"import styles from\"../../css/styles.module.css\";import React,{useEffect,useState}from\"react\";import{DesignUtils}from\"../utils/DesignUtils\";import{cm}from\"../setup/utils/cm\";import{MarkedProblemItem}from\"./MarkedProblemItem\";import{useApi}from\"../api/useApi\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function UserProgress(_ref){let{fromDate,toDate}=_ref;const{userApi,problemApi}=useApi();const[users,setUsers]=useState([]);const[problems,setProblems]=useState({});useEffect(()=>{getAllUsers();},[]);useEffect(()=>{getProblem();getWeeklyProblemSolved();},[fromDate,toDate]);const getAllUsers=()=>{userApi.getAllUsers(fromDate).then(_ref2=>{let{data}=_ref2;if(data){// console.table(data)\nsetUsers(data);}initLoad();});};const initLoad=()=>{problemApi.loadBaekjoon().then(_ref3=>{let{data}=_ref3;if(data){getProblem();}});};const getProblem=()=>{const body={from_date:fromDate,to_date:toDate,problem_id:-1};problemApi.getProblem(body).then(_ref4=>{let{status,data}=_ref4;const ob={};// console.table(data)\nif(data){for(const detail of data){ob[detail.id]={score:detail.score,problems:JSON.parse(detail.problems)};}setProblems(ob);}});};const getWeeklyProblemSolved=()=>{problemApi.getWeeklyProblemSolved(fromDate).then(_ref5=>{let{data}=_ref5;if(data){if(users){const copy=[...users];for(const user of copy){user.shared_solved=data[user.id];}setUsers(copy);}}});};const getProgressPercentage=(current,target)=>{if(current>target*2){return 110;}return Math.min(current/target*100,100);};const getProgressBarColor=(current,target)=>{const per=getProgressPercentage(current,target);if(per>100){return styles.p_over;}else if(per===100){return styles.p100;}else if(per>70){return styles.p70;}else if(per>30){return styles.p30;}else if(per>0){return styles.p10;}};return/*#__PURE__*/_jsxs(\"section\",{className:styles.progressSection,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.sectionTitle,children:\"\\uAC1C\\uBCC4 \\uC9C4\\uD589 \\uD604\\uD669\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.userProgressContainer,children:users&&users.map((user,i)=>{const problem=problems[user.id];// console.table(problem)\nconst score=problem?problem.score:0;const problemList=problem===null||problem===void 0?void 0:problem.problems;return/*#__PURE__*/_jsxs(\"div\",{className:cm(styles.userProgressCard,\"\".concat(score>=60&&styles.completed)),children:[/*#__PURE__*/_jsx(\"div\",{className:styles.userProgressAccent,style:{backgroundColor:DesignUtils.getTierColor(user.tier)}}),/*#__PURE__*/_jsxs(\"div\",{className:styles.userProgressHeader,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.userProgressInfo,children:[/*#__PURE__*/_jsx(\"span\",{className:cm(styles.tierIcon,\"\".concat(DesignUtils.getTierIconClass(user.tier)))}),/*#__PURE__*/_jsx(\"span\",{className:styles.userProgressName,children:user.name})]}),/*#__PURE__*/_jsx(\"span\",{className:cm(styles.userProgressHotStreak,\"\".concat(user.streak<=0&&styles.cold))}),/*#__PURE__*/_jsx(\"span\",{className:cm(styles.userProgressHotStreakNumber),children:user.streak>0&&user.streak})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.userProgressProgressContainer,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.userProgressBar,children:/*#__PURE__*/_jsx(\"div\",{className:cm(styles.userProgressFill,\"\".concat(getProgressBarColor(score,60))),style:{width:\"\".concat(getProgressPercentage(score,60),\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:styles.userProgressText,children:[score,\" / 60\",problemList&&/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'6px',color:'#ababab'},children:[\"(\",problemList.length,\"\\uAC1C)\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.userProgressChallengeProblems,children:/*#__PURE__*/_jsx(\"div\",{className:styles.userProgressProblemGrid,children:problemList&&problemList.map((problem,index)=>{return/*#__PURE__*/_jsx(MarkedProblemItem,{problem:problem,index:index},index);})})})]},i);})})]});}","map":{"version":3,"names":["styles","React","useEffect","useState","DesignUtils","cm","MarkedProblemItem","useApi","jsx","_jsx","jsxs","_jsxs","UserProgress","_ref","fromDate","toDate","userApi","problemApi","users","setUsers","problems","setProblems","getAllUsers","getProblem","getWeeklyProblemSolved","then","_ref2","data","initLoad","loadBaekjoon","_ref3","body","from_date","to_date","problem_id","_ref4","status","ob","detail","id","score","JSON","parse","_ref5","copy","user","shared_solved","getProgressPercentage","current","target","Math","min","getProgressBarColor","per","p_over","p100","p70","p30","p10","className","progressSection","children","sectionTitle","userProgressContainer","map","i","problem","problemList","userProgressCard","concat","completed","userProgressAccent","style","backgroundColor","getTierColor","tier","userProgressHeader","userProgressInfo","tierIcon","getTierIconClass","userProgressName","name","userProgressHotStreak","streak","cold","userProgressHotStreakNumber","userProgressProgressContainer","userProgressBar","userProgressFill","width","userProgressText","marginLeft","color","length","userProgressChallengeProblems","userProgressProblemGrid","index"],"sources":["/Users/chan/Baektracker/src/main/frontend/src/js/components/UserProgress.jsx"],"sourcesContent":["import styles from \"../../css/styles.module.css\";\nimport React, {useEffect, useState} from \"react\";\nimport {DesignUtils} from \"../utils/DesignUtils\";\nimport {cm} from \"../setup/utils/cm\"\nimport {MarkedProblemItem} from \"./MarkedProblemItem\";\nimport {useApi} from \"../api/useApi\";\n\nexport function UserProgress({fromDate, toDate}){\n    const {userApi, problemApi} = useApi();\n\n    const [users, setUsers] = useState([])\n    const [problems, setProblems] = useState({})\n\n    useEffect(() => {\n        getAllUsers()\n    }, []);\n\n    useEffect(() => {\n        getProblem();\n        getWeeklyProblemSolved()\n    }, [fromDate, toDate]);\n\n    const getAllUsers = ()=>{\n        userApi.getAllUsers(fromDate).then(({data})=>{\n            if(data){\n                // console.table(data)\n                setUsers(data);\n            }\n            initLoad();\n        })\n    }\n\n    const initLoad = ()=>{\n        problemApi.loadBaekjoon().then(({data})=>{\n            if(data){\n                getProblem()\n            }\n        })\n    }\n\n    const getProblem = ()=> {\n        const body = {\n            from_date: fromDate,\n            to_date: toDate,\n            problem_id: -1,\n        }\n\n        problemApi.getProblem(body).then(({status, data}) => {\n            const ob = {};\n            // console.table(data)\n            if(data){\n                for(const detail of data){\n                    ob[detail.id] = {\n                        score: detail.score,\n                        problems: JSON.parse(detail.problems)\n                    }\n                }\n                setProblems(ob);\n            }\n        })\n    }\n\n    const getWeeklyProblemSolved = ()=>{\n        problemApi.getWeeklyProblemSolved(fromDate).then(({data})=>{\n            if(data){\n                if(users){\n                    const copy = [...users]\n                    for(const user of copy){\n                        user.shared_solved = data[user.id]\n                    }\n                    setUsers(copy)\n                }\n            }\n        })\n    }\n    const getProgressPercentage = (current, target) => {\n        if(current > target * 2){\n            return 110\n        }\n        return Math.min((current / target) * 100, 100)\n    }\n\n    const getProgressBarColor = (current, target)=>{\n        const per = getProgressPercentage(current, target)\n        if(per > 100){\n            return styles.p_over\n        }else if(per === 100){\n            return styles.p100\n        }else if(per > 70){\n            return styles.p70\n        }else if(per > 30){\n            return styles.p30\n        }else if(per > 0){\n            return styles.p10\n        }\n    }\n\n    return (\n        <section className={styles.progressSection}>\n            <h2 className={styles.sectionTitle}>개별 진행 현황</h2>\n            <div className={styles.userProgressContainer}>\n                {users && users.map((user, i) => {\n                    const problem = problems[user.id];\n                    // console.table(problem)\n                    const score = problem ? problem.score : 0;\n\n                    const problemList = problem?.problems;\n                    return (\n                        <div key={i} className={cm(styles.userProgressCard, `${score >= 60 && styles.completed}`)}>\n                            <div className={styles.userProgressAccent}\n                                style={{backgroundColor: DesignUtils.getTierColor(user.tier)}}\n                            />\n                            <div className={styles.userProgressHeader}>\n                                <div className={styles.userProgressInfo}>\n                                    <span className={cm(styles.tierIcon, `${DesignUtils.getTierIconClass(user.tier)}`)}></span>\n                                    {/*<TierIcon tier={user.tier} size=\"small\"/>*/}\n                                    <span className={styles.userProgressName}>{user.name}</span>\n                                </div>\n                                <span className={cm(styles.userProgressHotStreak, `${user.streak <= 0 && styles.cold}`)}></span>\n                                <span className={cm(styles.userProgressHotStreakNumber)}>{user.streak > 0 && user.streak}</span>\n                                {/*{renderStreakIcon(user.streak, user.lastWeekFailed)}*/}\n                            </div>\n\n                            <div className={styles.userProgressProgressContainer}>\n                                <div className={styles.userProgressBar}>\n                                    <div\n                                        className={cm(styles.userProgressFill, `${getProgressBarColor(score, 60)}`)}\n                                        style={\n                                            {\n                                                width: `${getProgressPercentage(score, 60)}%`\n                                            }\n                                    }\n                                    />\n                                </div>\n                                <span className={styles.userProgressText}>\n                                {score} / 60\n                                    {\n                                        problemList && <span style={{\n                                            marginLeft: '6px',\n                                            color: '#ababab'\n                                        }}>({problemList.length}개)</span>\n                                    }\n                                </span>\n                            </div>\n\n                            <div className={styles.userProgressChallengeProblems}>\n                                <div className={styles.userProgressProblemGrid}>\n                                    {problemList && problemList.map((problem, index) => {\n                                        return (\n                                            <MarkedProblemItem key={index} problem={problem} index={index}/>\n                                        )\n                                    })}\n                                </div>\n                            </div>\n                        </div>\n                    )\n                })}\n            </div>\n        </section>\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}